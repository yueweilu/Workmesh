# åŠ¨æ€æŠ€èƒ½åˆ›å»ºç³»ç»Ÿ - é›†æˆå®Œæˆæ€»ç»“

## âœ… é›†æˆçŠ¶æ€ï¼šå·²å®Œæˆ

**æ—¥æœŸ**: 2026-01-28  
**çŠ¶æ€**: åç«¯é›†æˆå®Œæˆï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•

---

## å·²å®Œæˆçš„å·¥ä½œ

### 1. æ ¸å¿ƒç»„ä»¶ âœ…

#### SkillManager (src/agent/gemini/SkillManager.ts)

- âœ… æŠ€èƒ½éœ€æ±‚åˆ†æ
- âœ… è‡ªåŠ¨åˆ›å»ºæŠ€èƒ½
- âœ… æŠ€èƒ½åŠ è½½ç®¡ç†
- âœ… æŠ€èƒ½ä¿¡æ¯æŸ¥è¯¢

#### auto_create_skill.py (skills/skill-creator/scripts/)

- âœ… æ™ºèƒ½éœ€æ±‚è¯†åˆ«
- âœ… è‡ªåŠ¨ç”Ÿæˆ SKILL.md
- âœ… è‡ªåŠ¨ç”Ÿæˆ Python è„šæœ¬
- âœ… è‡ªåŠ¨å®‰è£…ä¾èµ–
- âœ… JSON æ ¼å¼è¾“å‡º

### 2. GeminiAgent é›†æˆ âœ…

#### å·²æ·»åŠ çš„åŠŸèƒ½

- âœ… SkillManager å¯¼å…¥å’Œåˆå§‹åŒ–
- âœ… autoCreateSkills é…ç½®é€‰é¡¹
- âœ… checkAndCreateSkills() æ–¹æ³•
- âœ… reloadSkills() æ–¹æ³•
- âœ… æŠ€èƒ½åˆ›å»ºäº‹ä»¶ç³»ç»Ÿ

#### äº‹ä»¶ç±»å‹

- `skill-creating` - æŠ€èƒ½åˆ›å»ºä¸­
- `skill-created` - æŠ€èƒ½åˆ›å»ºæˆåŠŸ
- `skill-creation-failed` - æŠ€èƒ½åˆ›å»ºå¤±è´¥

### 3. æ–‡æ¡£ âœ…

- âœ… `å®ç°æ€»ç»“.md` - å®Œæ•´å®ç°æ€»ç»“
- âœ… `åŠ¨æ€æŠ€èƒ½åˆ›å»º-ä½¿ç”¨æŒ‡å—.md` - ä½¿ç”¨æŒ‡å—
- âœ… `src/agent/gemini/integration-guide.md` - é›†æˆæŒ‡å—
- âœ… `tests/test-skill-integration.md` - æµ‹è¯•æŒ‡å—
- âœ… `tests/verify-integration.sh` - è‡ªåŠ¨éªŒè¯è„šæœ¬

---

## éªŒè¯ç»“æœ

è¿è¡Œ `./tests/verify-integration.sh` çš„ç»“æœï¼š

```
âœ“ æ‰€æœ‰æ£€æŸ¥é€šè¿‡ï¼é›†æˆæˆåŠŸï¼

é€šè¿‡: 23
å¤±è´¥: 0
```

**æ£€æŸ¥é¡¹ç›®**:

- âœ… æ ¸å¿ƒæ–‡ä»¶å­˜åœ¨
- âœ… SkillManager å·²å¯¼å…¥
- âœ… å±æ€§å’Œæ–¹æ³•å·²å®šä¹‰
- âœ… æ„é€ å‡½æ•°åˆå§‹åŒ–æ­£ç¡®
- âœ… send æ–¹æ³•é›†æˆå®Œæˆ
- âœ… äº‹ä»¶ç³»ç»Ÿå·²æ·»åŠ 
- âœ… Python è„šæœ¬å¯ç”¨
- âœ… æ–‡æ¡£å®Œæ•´

---

## å¦‚ä½•ä½¿ç”¨

### 1. é…ç½®ä¼šè¯

```typescript
const conversation = await ipcBridge.conversation.create({
  type: 'gemini',
  model: selectedModel,
  extra: {
    workspace: '/path/to/workspace',
    skillsDir: '/path/to/skills', // æŠ€èƒ½ç›®å½•
    enabledSkills: ['skill-creator'], // å¿…é¡»åŒ…å« skill-creator
    autoCreateSkills: true, // å¯ç”¨è‡ªåŠ¨åˆ›å»ºï¼ˆé»˜è®¤ï¼‰
  },
});
```

### 2. æµ‹è¯•è‡ªåŠ¨åˆ›å»º

å‘é€ä»¥ä¸‹æ¶ˆæ¯æµ‹è¯•ï¼š

```
ç”¨æˆ·: å¸®æˆ‘åˆ†æè¿™ä¸ª CSV æ–‡ä»¶çš„æ•°æ®åˆ†å¸ƒ

ç³»ç»Ÿè¡Œä¸º:
1. æ£€æµ‹åˆ°éœ€è¦ csv_analyzer æŠ€èƒ½
2. è‡ªåŠ¨åˆ›å»ºæŠ€èƒ½ï¼ˆ2-5ç§’ï¼‰
3. å‘é€é€šçŸ¥äº‹ä»¶
4. åŠ è½½æ–°æŠ€èƒ½
5. ä½¿ç”¨æ–°æŠ€èƒ½å¤„ç†è¯·æ±‚
```

### 3. æŸ¥çœ‹æ—¥å¿—

```bash
# æ§åˆ¶å°æ—¥å¿—
[GeminiAgent] Detecting need for new skill: csv analysis
[GeminiAgent] Creating skill: csv_analyzer
[GeminiAgent] Skill created successfully: csv_analyzer
[GeminiAgent] Skills reloaded: ['skill-creator', 'csv_analyzer']
```

### 4. éªŒè¯æŠ€èƒ½

```bash
# æ£€æŸ¥æŠ€èƒ½ç›®å½•
ls -la skills/csv_analyzer/

# åº”è¯¥çœ‹åˆ°:
# - SKILL.md (æŠ€èƒ½å®šä¹‰)
# - csv_analyzer.py (Python è„šæœ¬)
```

---

## æ”¯æŒçš„æŠ€èƒ½ç±»å‹

ç³»ç»Ÿå¯ä»¥è‡ªåŠ¨è¯†åˆ«å¹¶åˆ›å»ºä»¥ä¸‹ç±»å‹çš„æŠ€èƒ½ï¼š

| å…³é”®è¯               | æŠ€èƒ½ç±»å‹        | ä¾èµ–           |
| -------------------- | --------------- | -------------- |
| csv, analyze csv     | csv_analyzer    | pandas         |
| image, process image | image_processor | pillow         |
| api, http request    | api_caller      | requests       |
| json, parse json     | json_processor  | æ ‡å‡†åº“         |
| scrape, crawl        | web_scraper     | beautifulsoup4 |

---

## å·¥ä½œæµç¨‹

```
ç”¨æˆ·æ¶ˆæ¯
    â†“
analyzeSkillRequirement()
    â†“
éœ€è¦æ–°æŠ€èƒ½ï¼Ÿ
    â†“ æ˜¯
å‘é€ skill-creating äº‹ä»¶
    â†“
createSkill()
    â†“
auto_create_skill.py
    â†“
ç”Ÿæˆ SKILL.md + Python è„šæœ¬
    â†“
å®‰è£…ä¾èµ–
    â†“
loadSkill()
    â†“
reloadSkills()
    â†“
å‘é€ skill-created äº‹ä»¶
    â†“
ç»§ç»­å¤„ç†ç”¨æˆ·è¯·æ±‚
```

---

## å¾…å®Œæˆçš„å‰ç«¯é›†æˆï¼ˆå¯é€‰ï¼‰

### 1. ç”¨æˆ·é€šçŸ¥ (GeminiChat.tsx)

```typescript
useEffect(() => {
  const unsubscribe = ipcBridge.geminiConversation.responseStream.subscribe((msg) => {
    if (msg.type === 'skill-creating') {
      Message.info(`ğŸ”§ ${msg.data.message}`);
    } else if (msg.type === 'skill-created') {
      Message.success(`ğŸ‰ ${msg.data.message}`);
    } else if (msg.type === 'skill-creation-failed') {
      Message.warning(`âš ï¸ ${msg.data.message}`);
    }
  });

  return unsubscribe;
}, []);
```

### 2. è®¾ç½®ç•Œé¢ (SkillSettings.tsx)

```typescript
<Form.Item label="è‡ªåŠ¨åˆ›å»ºæŠ€èƒ½">
  <Switch
    checked={autoCreateSkills}
    onChange={(checked) => {
      setAutoCreateSkills(checked);
      ipcBridge.config.set('skills.autoCreate', checked);
    }}
  />
  <div className="form-item-tip">
    å½“æ£€æµ‹åˆ°éœ€è¦æ–°æŠ€èƒ½æ—¶è‡ªåŠ¨åˆ›å»º
  </div>
</Form.Item>
```

---

## æ€§èƒ½æŒ‡æ ‡

- **éœ€æ±‚åˆ†æ**: < 100ms
- **æ–‡ä»¶åˆ›å»º**: < 500ms
- **ä¾èµ–å®‰è£…**: 1-3s
- **æŠ€èƒ½åŠ è½½**: < 100ms
- **æ€»è€—æ—¶**: 2-5s

---

## æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: æŠ€èƒ½æœªåˆ›å»º

**å¯èƒ½åŸå› **:

- autoCreateSkills æœªå¯ç”¨
- skill-creator æœªåœ¨ enabledSkills ä¸­
- Python 3 æœªå®‰è£…

**è§£å†³æ–¹æ¡ˆ**:

```bash
# æ£€æŸ¥ Python
python3 --version

# æ‰‹åŠ¨æµ‹è¯•åˆ›å»º
python3 skills/skill-creator/scripts/auto_create_skill.py "Analyze CSV" skills
```

### é—®é¢˜ 2: ä¾èµ–å®‰è£…å¤±è´¥

**å¯èƒ½åŸå› **:

- pip æœªå®‰è£…
- ç½‘ç»œé—®é¢˜

**è§£å†³æ–¹æ¡ˆ**:

```bash
# æ‰‹åŠ¨å®‰è£…ä¾èµ–
pip install pandas pillow requests beautifulsoup4

# ä½¿ç”¨å›½å†…é•œåƒ
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple pandas
```

### é—®é¢˜ 3: æŠ€èƒ½æœªç”Ÿæ•ˆ

**å¯èƒ½åŸå› **:

- SKILL.md æ ¼å¼é”™è¯¯
- è„šæœ¬æƒé™é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**:

```bash
# æ£€æŸ¥æ–‡ä»¶
cat skills/csv_analyzer/SKILL.md

# æ·»åŠ æ‰§è¡Œæƒé™
chmod +x skills/csv_analyzer/csv_analyzer.py
```

---

## ä¸‹ä¸€æ­¥å»ºè®®

### ç«‹å³å¯åš

1. **å¯åŠ¨åº”ç”¨æµ‹è¯•**
   - åˆ›å»ºä¼šè¯å¹¶é…ç½® skillsDir
   - å‘é€æµ‹è¯•æ¶ˆæ¯
   - æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—

2. **éªŒè¯æŠ€èƒ½åˆ›å»º**
   - æ£€æŸ¥ skills ç›®å½•
   - æµ‹è¯•ç”Ÿæˆçš„è„šæœ¬
   - éªŒè¯æŠ€èƒ½åŠŸèƒ½

### çŸ­æœŸä¼˜åŒ– (1-2å‘¨)

1. **æ·»åŠ å‰ç«¯é€šçŸ¥**
   - å®ç°ç”¨æˆ·ç•Œé¢æç¤º
   - æ˜¾ç¤ºåˆ›å»ºè¿›åº¦

2. **æ·»åŠ æ›´å¤šæŠ€èƒ½æ¨¡æ¿**
   - è§†é¢‘å¤„ç† (opencv-python)
   - éŸ³é¢‘å¤„ç† (pydub)
   - æ•°æ®åº“æ“ä½œ (sqlite3)

3. **æ”¹è¿›é”™è¯¯å¤„ç†**
   - æ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
   - è‡ªåŠ¨é‡è¯•æœºåˆ¶

### ä¸­æœŸä¼˜åŒ– (1ä¸ªæœˆ)

1. **æŠ€èƒ½ç®¡ç†ç•Œé¢**
   - æŸ¥çœ‹å·²åˆ›å»ºçš„æŠ€èƒ½
   - ç¼–è¾‘æŠ€èƒ½é…ç½®
   - åˆ é™¤ä¸éœ€è¦çš„æŠ€èƒ½

2. **æ€§èƒ½ä¼˜åŒ–**
   - æŠ€èƒ½ç¼“å­˜
   - å¹¶è¡Œåˆ›å»º
   - å¢é‡åŠ è½½

3. **AI å¢å¼º**
   - ä½¿ç”¨ LLM åˆ†æéœ€æ±‚
   - ç”Ÿæˆæ›´å¤æ‚çš„è„šæœ¬
   - æ™ºèƒ½ä¼˜åŒ–å»ºè®®

---

## ç›¸å…³æ–‡æ¡£

| æ–‡æ¡£                                    | è¯´æ˜                     |
| --------------------------------------- | ------------------------ |
| `å®ç°æ€»ç»“.md`                           | å®Œæ•´çš„å®ç°æ€»ç»“å’ŒæŠ€æœ¯ç»†èŠ‚ |
| `åŠ¨æ€æŠ€èƒ½åˆ›å»º-ä½¿ç”¨æŒ‡å—.md`              | è¯¦ç»†çš„ä½¿ç”¨æŒ‡å—å’Œç¤ºä¾‹     |
| `src/agent/gemini/integration-guide.md` | é›†æˆæ­¥éª¤å’Œä»£ç ç¤ºä¾‹       |
| `tests/test-skill-integration.md`       | æµ‹è¯•æŒ‡å—å’ŒéªŒè¯æ­¥éª¤       |
| `tests/verify-integration.sh`           | è‡ªåŠ¨éªŒè¯è„šæœ¬             |

---

## æ€»ç»“

âœ… **åç«¯é›†æˆå·²å®Œæˆ**ï¼Œæ ¸å¿ƒåŠŸèƒ½å¯ç”¨  
â³ **å‰ç«¯é€šçŸ¥ä¸ºå¯é€‰**ï¼Œå¯ä»¥åç»­æ·»åŠ   
ğŸ¯ **ç°åœ¨å¯ä»¥å¼€å§‹æµ‹è¯•**è‡ªåŠ¨æŠ€èƒ½åˆ›å»ºåŠŸèƒ½

ç³»ç»Ÿå·²ç»å¯ä»¥ï¼š

- è‡ªåŠ¨æ£€æµ‹ç”¨æˆ·éœ€æ±‚
- åˆ›å»ºç›¸åº”çš„æŠ€èƒ½
- å®‰è£…å¿…è¦çš„ä¾èµ–
- åŠ è½½å¹¶ä½¿ç”¨æ–°æŠ€èƒ½

**å¼€å§‹ä½¿ç”¨**:

1. å¯åŠ¨åº”ç”¨
2. åˆ›å»ºä¼šè¯ï¼ˆé…ç½® skillsDir å’Œ enabledSkillsï¼‰
3. å‘é€æµ‹è¯•æ¶ˆæ¯ï¼ˆå¦‚ï¼š"å¸®æˆ‘åˆ†æ CSV æ–‡ä»¶"ï¼‰
4. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—å’Œ skills ç›®å½•

**è·å–å¸®åŠ©**:

- æŸ¥çœ‹ `tests/test-skill-integration.md` äº†è§£è¯¦ç»†æµ‹è¯•æ­¥éª¤
- è¿è¡Œ `./tests/verify-integration.sh` éªŒè¯é›†æˆçŠ¶æ€
- æŸ¥çœ‹ `å®ç°æ€»ç»“.md` äº†è§£æŠ€æœ¯ç»†èŠ‚

---

**åˆ›å»ºæ—¥æœŸ**: 2026-01-28  
**ç‰ˆæœ¬**: 1.0.0  
**çŠ¶æ€**: âœ… é›†æˆå®Œæˆï¼Œå¯ä»¥æµ‹è¯•
