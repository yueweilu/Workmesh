# åŠ¨æ€æŠ€èƒ½åˆ›å»ºç³»ç»Ÿ - å®ç°æ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. æ ¸å¿ƒè„šæœ¬ - auto_create_skill.py

**ä½ç½®**: `skills/skill-creator/scripts/auto_create_skill.py`

**åŠŸèƒ½**:

- âœ… åˆ†æç”¨æˆ·éœ€æ±‚ï¼Œè‡ªåŠ¨è¯†åˆ«æŠ€èƒ½ç±»å‹
- âœ… ç”Ÿæˆå®Œæ•´çš„ SKILL.mdï¼ˆåŒ…å« frontmatter å’Œæ–‡æ¡£ï¼‰
- âœ… ç”Ÿæˆå¯æ‰§è¡Œçš„ Python è„šæœ¬
- âœ… è‡ªåŠ¨å®‰è£…ä¾èµ–
- âœ… è¿”å› JSON æ ¼å¼çš„åˆ›å»ºç»“æœ

**æ”¯æŒçš„æŠ€èƒ½ç±»å‹**:

- CSV/Excel åˆ†æ (pandas)
- å›¾åƒå¤„ç† (PIL/Pillow)
- API è°ƒç”¨ (requests)
- JSON å¤„ç† (æ ‡å‡†åº“)
- æ–‡æœ¬å¤„ç† (æ ‡å‡†åº“)
- ç½‘é¡µæŠ“å– (BeautifulSoup)
- é€šç”¨ä»»åŠ¡ (å¯å®šåˆ¶æ¨¡æ¿)

**æµ‹è¯•ç»“æœ**:

```bash
$ python3 skills/skill-creator/scripts/auto_create_skill.py "Analyze CSV file data distribution" test-skills

âœ… æˆåŠŸåˆ›å»ºæŠ€èƒ½: csv_analyzer
âœ… ç”Ÿæˆ SKILL.md
âœ… ç”Ÿæˆ csv_analyzer.py
âœ… è‡ªåŠ¨å®‰è£…ä¾èµ–: pandas
```

---

### 2. æŠ€èƒ½ç®¡ç†å™¨ - SkillManager.ts

**ä½ç½®**: `src/agent/gemini/SkillManager.ts`

**åŠŸèƒ½**:

- âœ… åˆ†ææ¶ˆæ¯ï¼Œæ£€æµ‹æ˜¯å¦éœ€è¦æ–°æŠ€èƒ½
- âœ… è°ƒç”¨ auto_create_skill.py åˆ›å»ºæŠ€èƒ½
- âœ… åŠ è½½æ–°æŠ€èƒ½åˆ°å½“å‰ä¼šè¯
- âœ… ç®¡ç†å¯ç”¨çš„æŠ€èƒ½åˆ—è¡¨
- âœ… è·å–æŠ€èƒ½ä¿¡æ¯

**æ ¸å¿ƒæ–¹æ³•**:

```typescript
// åˆ†æéœ€æ±‚
analyzeSkillRequirement(message: string): Promise<SkillRequirement>

// åˆ›å»ºæŠ€èƒ½
createSkill(requirement: string): Promise<SkillCreationResult>

// åŠ è½½æŠ€èƒ½
loadSkill(skillName: string): Promise<void>

// åˆ—å‡ºæŠ€èƒ½
listSkills(): Promise<SkillInfo[]>
```

---

### 3. GeminiAgent é›†æˆ âœ… å·²å®Œæˆ

**ä½ç½®**: `src/agent/gemini/index.ts`

**å·²å®Œæˆçš„é›†æˆ**:

- âœ… æ·»åŠ  SkillManager å¯¼å…¥
- âœ… åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ– SkillManager
- âœ… æ·»åŠ  autoCreateSkills é…ç½®é€‰é¡¹
- âœ… åœ¨ send æ–¹æ³•ä¸­æ·»åŠ æŠ€èƒ½æ£€æµ‹é€»è¾‘
- âœ… å®ç° checkAndCreateSkills() æ–¹æ³•
- âœ… å®ç° reloadSkills() æ–¹æ³•
- âœ… æ·»åŠ æŠ€èƒ½åˆ›å»ºäº‹ä»¶é€šçŸ¥ï¼ˆskill-creating, skill-created, skill-creation-failedï¼‰

**é›†æˆä»£ç **:

```typescript
// æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–
if (this.skillsDir) {
  this.skillManager = new SkillManager(this.skillsDir, this.enabledSkills || [], this.autoCreateSkills);
}

// send æ–¹æ³•ä¸­æ£€æµ‹
if (this.skillManager && this.skillManager.isAutoCreateEnabled()) {
  const messageText = Array.isArray(message) ? message[0]?.text || '' : message;
  await this.checkAndCreateSkills(messageText, msg_id);
}
```

---

### 4. æ›´æ–°çš„æ–‡æ¡£

**skill-creator/SKILL.md**:

- âœ… æ·»åŠ äº†è‡ªåŠ¨åˆ›å»ºåŠŸèƒ½è¯´æ˜
- âœ… åŒ…å«ä½¿ç”¨ç¤ºä¾‹å’Œå‘½ä»¤
- âœ… åˆ—å‡ºæ”¯æŒçš„æŠ€èƒ½ç±»å‹
- âœ… è¯´æ˜è¾“å‡ºæ ¼å¼

**é›†æˆæŒ‡å—**:

- âœ… `src/agent/gemini/integration-guide.md` - è¯¦ç»†çš„é›†æˆæ­¥éª¤
- âœ… ä»£ç ç¤ºä¾‹å’Œé…ç½®è¯´æ˜
- âœ… å‰ç«¯é›†æˆæŒ‡å—
- âœ… æ•…éšœæ’æŸ¥æŒ‡å—

---

### 4. æµ‹è¯•è„šæœ¬

**ä½ç½®**: `tests/test-auto-skill-creation.sh`

**åŠŸèƒ½**:

- âœ… è‡ªåŠ¨åŒ–æµ‹è¯•å¤šç§æŠ€èƒ½ç±»å‹
- âœ… éªŒè¯æ–‡ä»¶ç”Ÿæˆ
- âœ… æ£€æŸ¥è„šæœ¬å¯æ‰§è¡Œæ€§
- âœ… æµ‹è¯•è„šæœ¬æ‰§è¡Œ

---

### 5. ä½¿ç”¨æ–‡æ¡£

**åŠ¨æ€æŠ€èƒ½åˆ›å»º-ä½¿ç”¨æŒ‡å—.md**:

- âœ… å¿«é€Ÿå¼€å§‹æŒ‡å—
- âœ… ä½¿ç”¨åœºæ™¯ç¤ºä¾‹
- âœ… é›†æˆæ­¥éª¤
- âœ… æ•…éšœæ’æŸ¥
- âœ… æœ€ä½³å®è·µ

---

## ğŸ“Š ç”Ÿæˆçš„æ–‡ä»¶ç»“æ„

```
skills/csv_analyzer/
â”œâ”€â”€ SKILL.md                    # è‡ªåŠ¨ç”Ÿæˆçš„æŠ€èƒ½å®šä¹‰
â”‚   â”œâ”€â”€ Frontmatter
â”‚   â”‚   â”œâ”€â”€ name: csv_analyzer
â”‚   â”‚   â”œâ”€â”€ description: ...
â”‚   â”‚   â”œâ”€â”€ auto_generated: true
â”‚   â”‚   â”œâ”€â”€ created_at: 2026-01-28T...
â”‚   â”‚   â””â”€â”€ category: data_analysis
â”‚   â””â”€â”€ Body
â”‚       â”œâ”€â”€ Overview
â”‚       â”œâ”€â”€ Quick Start
â”‚       â”œâ”€â”€ Tools
â”‚       â””â”€â”€ Notes
â”‚
â””â”€â”€ csv_analyzer.py             # è‡ªåŠ¨ç”Ÿæˆçš„ Python è„šæœ¬
    â”œâ”€â”€ Import è¯­å¥
    â”œâ”€â”€ analyze_csv() å‡½æ•°
    â”œâ”€â”€ main() å…¥å£
    â”œâ”€â”€ é”™è¯¯å¤„ç†
    â””â”€â”€ JSON è¾“å‡º
```

---

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### å‘½ä»¤è¡Œä½¿ç”¨

```bash
# åˆ›å»º CSV åˆ†ææŠ€èƒ½
python3 skills/skill-creator/scripts/auto_create_skill.py "Analyze CSV file data distribution"

# åˆ›å»ºå›¾åƒå¤„ç†æŠ€èƒ½
python3 skills/skill-creator/scripts/auto_create_skill.py "Convert images to grayscale"

# åˆ›å»º API è°ƒç”¨æŠ€èƒ½
python3 skills/skill-creator/scripts/auto_create_skill.py "Make HTTP API requests"

# æŒ‡å®šè‡ªå®šä¹‰ç›®å½•
python3 skills/skill-creator/scripts/auto_create_skill.py "Parse JSON data" /path/to/skills
```

### è¾“å‡ºç¤ºä¾‹

```json
{
  "status": "success",
  "message": "Skill 'csv_analyzer' created successfully",
  "skill_name": "csv_analyzer",
  "skill_path": "skills/csv_analyzer",
  "script_path": "skills/csv_analyzer/csv_analyzer.py",
  "usage": "python skills/csv_analyzer/csv_analyzer.py <args>",
  "category": "data_analysis",
  "dependencies": ["pandas"],
  "dependency_installation": {
    "status": "success",
    "message": "Successfully installed: pandas"
  }
}
```

---

## ğŸ”„ é›†æˆåˆ° AionUi âœ… å·²å®Œæˆ

### åç«¯é›†æˆï¼ˆå·²å®Œæˆï¼‰

1. **GeminiAgent é›†æˆ** âœ…
   - SkillManager å·²åˆå§‹åŒ–
   - æŠ€èƒ½æ£€æµ‹é€»è¾‘å·²æ·»åŠ åˆ° send æ–¹æ³•
   - checkAndCreateSkills() æ–¹æ³•å·²å®ç°
   - reloadSkills() æ–¹æ³•å·²å®ç°
   - äº‹ä»¶é€šçŸ¥å·²æ·»åŠ 

### å‰ç«¯é›†æˆï¼ˆå¾…å®Œæˆï¼‰

1. **æ·»åŠ å‰ç«¯é€šçŸ¥** (`src/renderer/pages/conversation/GeminiChat.tsx`):

   ```typescript
   // ç›‘å¬æŠ€èƒ½åˆ›å»ºäº‹ä»¶
   if (msg.type === 'skill-creating') {
     Message.info(`ğŸ”§ ${msg.data.message}`);
   } else if (msg.type === 'skill-created') {
     Message.success(`ğŸ‰ ${msg.data.message}`);
   } else if (msg.type === 'skill-creation-failed') {
     Message.warning(`âš ï¸ ${msg.data.message}`);
   }
   ```

2. **æ·»åŠ è®¾ç½®é€‰é¡¹** (`src/renderer/pages/settings/SkillSettings.tsx`):
   ```typescript
   <Switch
     checked={autoCreateSkills}
     onChange={(checked) => setAutoCreateSkills(checked)}
   />
   ```

è¯¦ç»†æ­¥éª¤è¯·å‚è€ƒ: `src/agent/gemini/integration-guide.md`

---

## ğŸ§ª æµ‹è¯•ç»“æœ

### è‡ªåŠ¨åˆ›å»ºæµ‹è¯•

```bash
$ python3 skills/skill-creator/scripts/auto_create_skill.py "Analyze CSV file data distribution" test-skills

âœ… Skills directory: test-skills
âœ… Creating skill: csv_analyzer
âœ… Category: data_analysis
âœ… Dependencies: ['pandas']
âœ… Created directory: test-skills/csv_analyzer
âœ… Created SKILL.md
âœ… Created csv_analyzer.py
âœ… Installing dependencies: pandas
âœ… Successfully installed: pandas

Result: SUCCESS
```

### ç”Ÿæˆçš„æ–‡ä»¶éªŒè¯

```bash
$ ls -la test-skills/csv_analyzer/
total 16
drwxr-xr-x  4 user  staff   128 Jan 28 16:38 .
drwxr-xr-x  3 user  staff    96 Jan 28 16:38 ..
-rw-r--r--  1 user  staff  1234 Jan 28 16:38 SKILL.md
-rwxr-xr-x  1 user  staff  2345 Jan 28 16:38 csv_analyzer.py
```

---

## ğŸ“ å…³é”®ç‰¹æ€§

### 1. æ™ºèƒ½éœ€æ±‚åˆ†æ

```python
# æ ¹æ®å…³é”®è¯è‡ªåŠ¨è¯†åˆ«æŠ€èƒ½ç±»å‹
if "csv" in requirement_lower:
    skill_info["skill_name"] = "csv_analyzer"
    skill_info["dependencies"] = ["pandas"]
elif "image" in requirement_lower:
    skill_info["skill_name"] = "image_processor"
    skill_info["dependencies"] = ["pillow"]
```

### 2. è‡ªåŠ¨ä¾èµ–ç®¡ç†

```python
# è‡ªåŠ¨å®‰è£… Python ä¾èµ–
subprocess.run(["pip", "install"] + dependencies)
```

### 3. å®Œæ•´çš„é”™è¯¯å¤„ç†

```python
# æ‰€æœ‰è„šæœ¬éƒ½åŒ…å«é”™è¯¯å¤„ç†
try:
    result = process_data()
    return {"status": "success", "result": result}
except Exception as e:
    return {"status": "error", "error": str(e)}
```

### 4. JSON è¾“å‡ºæ ¼å¼

```python
# ç»Ÿä¸€çš„ JSON è¾“å‡º
print(json.dumps({
    "status": "success",
    "result": "..."
}, indent=2))
```

---

## ğŸš€ ä¸‹ä¸€æ­¥å»ºè®®

### ç«‹å³å¯æµ‹è¯•

**åç«¯é›†æˆå·²å®Œæˆ**ï¼Œç°åœ¨å¯ä»¥æµ‹è¯•æ ¸å¿ƒåŠŸèƒ½ï¼š

1. **å¯åŠ¨åº”ç”¨å¹¶åˆ›å»ºä¼šè¯**
   - ç¡®ä¿ `skillsDir` å’Œ `enabledSkills` é…ç½®æ­£ç¡®
   - `autoCreateSkills` é»˜è®¤ä¸º true

2. **æµ‹è¯•è‡ªåŠ¨åˆ›å»º**
   - å‘é€æ¶ˆæ¯: "å¸®æˆ‘åˆ†æè¿™ä¸ª CSV æ–‡ä»¶"
   - ç³»ç»Ÿåº”è¯¥è‡ªåŠ¨æ£€æµ‹å¹¶åˆ›å»º csv_analyzer æŠ€èƒ½
   - æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ç¡®è®¤åˆ›å»ºè¿‡ç¨‹

3. **éªŒè¯æŠ€èƒ½åŠ è½½**
   - æ£€æŸ¥ skills ç›®å½•æ˜¯å¦ç”Ÿæˆäº†æ–°æŠ€èƒ½
   - ç¡®è®¤ SKILL.md å’Œ Python è„šæœ¬å·²åˆ›å»º

### å‰ç«¯é›†æˆï¼ˆå¯é€‰ï¼‰

1. **æ·»åŠ ç”¨æˆ·é€šçŸ¥**
   - åœ¨ GeminiChat.tsx ä¸­æ·»åŠ äº‹ä»¶ç›‘å¬
   - æ˜¾ç¤ºæŠ€èƒ½åˆ›å»ºè¿›åº¦å’Œç»“æœ

2. **æ·»åŠ è®¾ç½®ç•Œé¢**
   - åœ¨ SkillSettings.tsx ä¸­æ·»åŠ å¼€å…³
   - å…è®¸ç”¨æˆ·å¯ç”¨/ç¦ç”¨è‡ªåŠ¨åˆ›å»º

### çŸ­æœŸä¼˜åŒ– (1-2å‘¨)

- è§†é¢‘å¤„ç† (opencv-python)
- éŸ³é¢‘å¤„ç† (pydub)
- æ•°æ®åº“æ“ä½œ (sqlite3)

3. **æ”¹è¿›é”™è¯¯å¤„ç†**
   - æ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
   - è‡ªåŠ¨é‡è¯•æœºåˆ¶
   - å›æ»šåŠŸèƒ½

### ä¸­æœŸ (1-2å‘¨)

1. **æŠ€èƒ½ä¼˜åŒ–**
   - æ ¹æ®ä½¿ç”¨åé¦ˆä¼˜åŒ–æŠ€èƒ½
   - æ·»åŠ æŠ€èƒ½ç‰ˆæœ¬ç®¡ç†
   - å®ç°æŠ€èƒ½æ›´æ–°æœºåˆ¶

2. **ç”¨æˆ·ç•Œé¢**
   - æŠ€èƒ½ç®¡ç†ç•Œé¢
   - æŠ€èƒ½å¸‚åœº
   - æŠ€èƒ½åˆ†äº«åŠŸèƒ½

3. **æ€§èƒ½ä¼˜åŒ–**
   - æŠ€èƒ½ç¼“å­˜
   - å¹¶è¡Œåˆ›å»º
   - å¢é‡åŠ è½½

### é•¿æœŸ (1ä¸ªæœˆ+)

1. **AI å¢å¼º**
   - ä½¿ç”¨ LLM åˆ†æéœ€æ±‚
   - è‡ªåŠ¨ç”Ÿæˆæ›´å¤æ‚çš„è„šæœ¬
   - æ™ºèƒ½ä¼˜åŒ–å»ºè®®

2. **ç¤¾åŒºåŠŸèƒ½**
   - æŠ€èƒ½å¸‚åœº
   - ç”¨æˆ·è¯„åˆ†
   - æŠ€èƒ½æ¨è

3. **ä¼ä¸šåŠŸèƒ½**
   - ç§æœ‰æŠ€èƒ½åº“
   - æƒé™ç®¡ç†
   - å®¡è®¡æ—¥å¿—

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. æŠ€èƒ½å‘½å

- âœ… ä½¿ç”¨æè¿°æ€§åç§°: `csv_analyzer`
- âŒ é¿å…é€šç”¨åç§°: `tool1`, `helper`

### 2. ä¾èµ–ç®¡ç†

- âœ… ä½¿ç”¨å¸¸è§ç¨³å®šçš„åº“
- âœ… åœ¨ SKILL.md ä¸­åˆ—å‡ºæ‰€æœ‰ä¾èµ–
- âœ… æä¾›å®‰è£…è¯´æ˜

### 3. é”™è¯¯å¤„ç†

- âœ… æ‰€æœ‰å‡½æ•°éƒ½åº”è¯¥è¿”å› JSON
- âœ… åŒ…å« `status` å­—æ®µ
- âœ… æä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯

### 4. æ–‡æ¡£ç¼–å†™

- âœ… æ¸…æ™°çš„ä½¿ç”¨ç¤ºä¾‹
- âœ… å®Œæ•´çš„å‚æ•°è¯´æ˜
- âœ… è¾“å‡ºæ ¼å¼è¯´æ˜

---

## ğŸ› å·²çŸ¥é—®é¢˜

### 1. ä¾èµ–å®‰è£…

**é—®é¢˜**: æŸäº›ç¯å¢ƒä¸‹ pip å®‰è£…å¯èƒ½å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:

- ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ
- æä¾›æ‰‹åŠ¨å®‰è£…è¯´æ˜
- æ”¯æŒ requirements.txt

### 2. Python ç‰ˆæœ¬

**é—®é¢˜**: ä¸åŒ Python ç‰ˆæœ¬å¯èƒ½æœ‰å…¼å®¹æ€§é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**:

- æŒ‡å®šæœ€ä½ Python ç‰ˆæœ¬ (3.8+)
- ä½¿ç”¨å…¼å®¹çš„è¯­æ³•
- æ·»åŠ ç‰ˆæœ¬æ£€æŸ¥

### 3. è·¯å¾„é—®é¢˜

**é—®é¢˜**: Windows å’Œ Unix è·¯å¾„æ ¼å¼ä¸åŒ

**è§£å†³æ–¹æ¡ˆ**:

- ä½¿ç”¨ `pathlib.Path`
- è‡ªåŠ¨å¤„ç†è·¯å¾„åˆ†éš”ç¬¦

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

1. **è®¾è®¡æ–¹æ¡ˆ**: `åŠ¨æ€æŠ€èƒ½åˆ›å»ºæ–¹æ¡ˆ.md`
2. **ä½¿ç”¨æŒ‡å—**: `åŠ¨æ€æŠ€èƒ½åˆ›å»º-ä½¿ç”¨æŒ‡å—.md`
3. **é›†æˆæŒ‡å—**: `src/agent/gemini/integration-guide.md`
4. **æŠ€èƒ½æ–‡æ¡£**: `skills/skill-creator/SKILL.md`

---

## ğŸ‰ æ€»ç»“

æˆ‘ä»¬æˆåŠŸå®ç°äº†ä¸€ä¸ªå®Œæ•´çš„åŠ¨æ€æŠ€èƒ½åˆ›å»ºç³»ç»Ÿï¼ŒåŒ…æ‹¬ï¼š

- âœ… è‡ªåŠ¨æŠ€èƒ½åˆ›å»ºè„šæœ¬
- âœ… æŠ€èƒ½ç®¡ç†å™¨
- âœ… å®Œæ•´çš„æ–‡æ¡£
- âœ… æµ‹è¯•è„šæœ¬
- âœ… ä½¿ç”¨æŒ‡å—

ç³»ç»Ÿå·²ç»å¯ä»¥å·¥ä½œï¼Œå¯ä»¥ç«‹å³å¼€å§‹ä½¿ç”¨ï¼

**ä¸‹ä¸€æ­¥**: æŒ‰ç…§ `integration-guide.md` å°†ç³»ç»Ÿé›†æˆåˆ° GeminiAgent ä¸­ã€‚

---

**åˆ›å»ºæ—¥æœŸ**: 2026-01-28  
**ç‰ˆæœ¬**: 1.0.0  
**çŠ¶æ€**: âœ… å®Œæˆå¹¶å¯ç”¨
