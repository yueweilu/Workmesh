# åŠ¨æ€æŠ€èƒ½åˆ›å»ºç³»ç»Ÿ - ä½¿ç”¨æŒ‡å—

> **è®© AI èƒ½å¤Ÿè‡ªä¸»å­¦ä¹ æ–°æŠ€èƒ½ï¼**

---

## ğŸ‰ å·²å®Œæˆçš„å®ç°

### âœ… æ ¸å¿ƒç»„ä»¶

1. **auto_create_skill.py** - è‡ªåŠ¨æŠ€èƒ½åˆ›å»ºè„šæœ¬
   - ä½ç½®: `skills/skill-creator/scripts/auto_create_skill.py`
   - åŠŸèƒ½: æ ¹æ®éœ€æ±‚æè¿°è‡ªåŠ¨ç”Ÿæˆå®Œæ•´çš„æŠ€èƒ½

2. **SkillManager.ts** - æŠ€èƒ½ç®¡ç†å™¨
   - ä½ç½®: `src/agent/gemini/SkillManager.ts`
   - åŠŸèƒ½: æ£€æµ‹éœ€æ±‚ã€åˆ›å»ºæŠ€èƒ½ã€åŠ è½½æŠ€èƒ½

3. **æ›´æ–°çš„ SKILL.md** - æŠ€èƒ½åˆ›å»ºå™¨æ–‡æ¡£
   - ä½ç½®: `skills/skill-creator/SKILL.md`
   - åŠŸèƒ½: åŒ…å«è‡ªåŠ¨åˆ›å»ºåŠŸèƒ½çš„å®Œæ•´è¯´æ˜

4. **é›†æˆæŒ‡å—** - GeminiAgent é›†æˆæ–‡æ¡£
   - ä½ç½®: `src/agent/gemini/integration-guide.md`
   - åŠŸèƒ½: è¯¦ç»†çš„é›†æˆæ­¥éª¤å’Œç¤ºä¾‹

5. **æµ‹è¯•è„šæœ¬** - è‡ªåŠ¨åŒ–æµ‹è¯•
   - ä½ç½®: `tests/test-auto-skill-creation.sh`
   - åŠŸèƒ½: éªŒè¯è‡ªåŠ¨åˆ›å»ºåŠŸèƒ½

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. æµ‹è¯•è‡ªåŠ¨åˆ›å»ºåŠŸèƒ½

```bash
# è¿è¡Œæµ‹è¯•è„šæœ¬
./tests/test-auto-skill-creation.sh
```

### 2. æ‰‹åŠ¨åˆ›å»ºæŠ€èƒ½

```bash
# åˆ›å»º CSV åˆ†ææŠ€èƒ½
python3 skills/skill-creator/scripts/auto_create_skill.py "Analyze CSV file data distribution"

# åˆ›å»ºå›¾åƒå¤„ç†æŠ€èƒ½
python3 skills/skill-creator/scripts/auto_create_skill.py "Convert images to grayscale"

# åˆ›å»º API è°ƒç”¨æŠ€èƒ½
python3 skills/skill-creator/scripts/auto_create_skill.py "Make HTTP API requests"
```

### 3. æŸ¥çœ‹åˆ›å»ºçš„æŠ€èƒ½

```bash
# æŸ¥çœ‹æŠ€èƒ½ç›®å½•
ls -la skills/csv_analyzer/

# æŸ¥çœ‹ SKILL.md
cat skills/csv_analyzer/SKILL.md

# æµ‹è¯•è„šæœ¬
python3 skills/csv_analyzer/csv_analyzer.py test.csv
```

---

## ğŸ“– ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1: CSV æ•°æ®åˆ†æ

**ç”¨æˆ·è¯·æ±‚**:

```
å¸®æˆ‘åˆ†æè¿™ä¸ª sales_data.csv æ–‡ä»¶çš„æ•°æ®åˆ†å¸ƒ
```

**AI è‡ªåŠ¨æµç¨‹**:

1. æ£€æµ‹åˆ°éœ€è¦ CSV åˆ†æåŠŸèƒ½
2. æ£€æŸ¥ç°æœ‰æŠ€èƒ½ â†’ æœªæ‰¾åˆ° csv_analyzer
3. è‡ªåŠ¨åˆ›å»º csv_analyzer æŠ€èƒ½
4. æ‰§è¡Œåˆ†æå¹¶è¿”å›ç»“æœ

**ç”¨æˆ·ä½“éªŒ**:

```
ğŸ”§ Detecting need for new skill: csv analysis
ğŸ‰ Created new skill: csv_analyzer

åˆ†æç»“æœ:
- æ€»è¡Œæ•°: 1000
- åˆ—æ•°: 5
- åˆ—å: date, product, quantity, price, total
- æ•°æ®ç±»å‹: ...
- ç¼ºå¤±å€¼: æ— 
- æ•°å€¼ç»Ÿè®¡: ...
```

### åœºæ™¯ 2: å›¾åƒå¤„ç†

**ç”¨æˆ·è¯·æ±‚**:

```
æŠŠè¿™å¼ å›¾ç‰‡è½¬æ¢æˆç°åº¦å›¾
```

**AI è‡ªåŠ¨æµç¨‹**:

1. æ£€æµ‹åˆ°éœ€è¦å›¾åƒå¤„ç†åŠŸèƒ½
2. è‡ªåŠ¨åˆ›å»º image_processor æŠ€èƒ½
3. æ‰§è¡Œå›¾åƒè½¬æ¢
4. è¿”å›ç»“æœ

**ç”¨æˆ·ä½“éªŒ**:

```
ğŸ”§ Creating image processing skill...
ğŸ‰ New skill created: image_processor
âœ… Image converted to grayscale
ä¿å­˜ä½ç½®: output_grayscale.png
```

### åœºæ™¯ 3: API è°ƒç”¨

**ç”¨æˆ·è¯·æ±‚**:

```
å¸®æˆ‘è°ƒç”¨è¿™ä¸ª API: https://api.example.com/data
```

**AI è‡ªåŠ¨æµç¨‹**:

1. æ£€æµ‹åˆ°éœ€è¦ API è°ƒç”¨åŠŸèƒ½
2. è‡ªåŠ¨åˆ›å»º api_caller æŠ€èƒ½
3. æ‰§è¡Œ API è¯·æ±‚
4. è¿”å›å“åº”æ•°æ®

---

## ğŸ› ï¸ é›†æˆåˆ° AionUi

### æ­¥éª¤ 1: ä¿®æ”¹ GeminiAgent

åœ¨ `src/agent/gemini/index.ts` ä¸­æ·»åŠ ï¼š

```typescript
import { SkillManager } from './SkillManager';

export class GeminiAgent {
  private skillManager: SkillManager | null = null;

  constructor(options: GeminiAgent2Options) {
    // ... ç°æœ‰ä»£ç 

    // åˆå§‹åŒ– SkillManager
    if (options.skillsDir) {
      this.skillManager = new SkillManager(
        options.skillsDir,
        options.enabledSkills || [],
        true // å¯ç”¨è‡ªåŠ¨åˆ›å»º
      );
    }
  }

  async send(params: { input: string; msg_id: string; files?: string[] }): Promise<void> {
    // æ£€æŸ¥å¹¶åˆ›å»ºæŠ€èƒ½
    if (this.skillManager) {
      await this.checkAndCreateSkills(params.input, params.msg_id);
    }

    // ç»§ç»­åŸæœ‰é€»è¾‘
    // ...
  }

  private async checkAndCreateSkills(message: string, msg_id: string): Promise<void> {
    const requirement = await this.skillManager!.analyzeSkillRequirement(message);

    if (requirement.needed && requirement.requirement) {
      // é€šçŸ¥ç”¨æˆ·
      this.onStreamEvent({
        type: 'skill-creating',
        data: { message: `Creating skill: ${requirement.requirement}` },
        msg_id,
      });

      // åˆ›å»ºæŠ€èƒ½
      const result = await this.skillManager!.createSkill(requirement.requirement);

      if (result.status === 'success') {
        // åŠ è½½æŠ€èƒ½
        await this.skillManager!.loadSkill(result.skill_name!);

        // é€šçŸ¥ç”¨æˆ·
        this.onStreamEvent({
          type: 'skill-created',
          data: { skill_name: result.skill_name, message: 'Skill created!' },
          msg_id,
        });
      }
    }
  }
}
```

### æ­¥éª¤ 2: æ·»åŠ å‰ç«¯é€šçŸ¥

åœ¨ `src/renderer/pages/conversation/GeminiChat.tsx` ä¸­æ·»åŠ ï¼š

```typescript
import { Message } from '@arco-design/web-react';

useEffect(() => {
  const unsubscribe = ipcBridge.geminiConversation.responseStream.subscribe((msg) => {
    if (msg.type === 'skill-creating') {
      Message.info({
        content: `ğŸ”§ ${msg.data.message}`,
        duration: 3000,
      });
    } else if (msg.type === 'skill-created') {
      Message.success({
        content: `ğŸ‰ New skill: ${msg.data.skill_name}`,
        duration: 5000,
      });
    }
  });

  return unsubscribe;
}, []);
```

### æ­¥éª¤ 3: æ·»åŠ è®¾ç½®é€‰é¡¹

åœ¨ `src/renderer/pages/settings/SkillSettings.tsx` ä¸­æ·»åŠ ï¼š

```typescript
<div className="setting-item">
  <div>
    <Typography.Text>Auto-create Skills</Typography.Text>
    <Typography.Text type="secondary">
      Automatically create new skills when needed
    </Typography.Text>
  </div>
  <Switch
    checked={autoCreateSkills}
    onChange={(checked) => {
      setAutoCreateSkills(checked);
      ipcBridge.config.set('skills.autoCreate', checked);
    }}
  />
</div>
```

---

## ğŸ¯ æ”¯æŒçš„æŠ€èƒ½ç±»å‹

| ç±»å‹          | å…³é”®è¯                  | ç”Ÿæˆå†…å®¹             |
| ------------- | ----------------------- | -------------------- |
| **CSV åˆ†æ**  | csv, excel, spreadsheet | pandas æ•°æ®åˆ†æè„šæœ¬  |
| **å›¾åƒå¤„ç†**  | image, picture, photo   | PIL/Pillow å›¾åƒå¤„ç†  |
| **API è°ƒç”¨**  | api, http, rest         | requests HTTP å®¢æˆ·ç«¯ |
| **JSON å¤„ç†** | json, parse, format     | JSON è§£æå™¨          |
| **æ–‡æœ¬å¤„ç†**  | text, string            | æ–‡æœ¬å¤„ç†å·¥å…·         |
| **ç½‘é¡µæŠ“å–**  | web, scrape, crawl      | BeautifulSoup çˆ¬è™«   |
| **é€šç”¨ä»»åŠ¡**  | (å…¶ä»–)                  | å¯å®šåˆ¶æ¨¡æ¿           |

---

## ğŸ“‹ ç”Ÿæˆçš„æ–‡ä»¶ç»“æ„

```
skills/csv_analyzer/
â”œâ”€â”€ SKILL.md                    # æŠ€èƒ½å®šä¹‰
â”‚   â”œâ”€â”€ Frontmatter (YAML)
â”‚   â”‚   â”œâ”€â”€ name: csv_analyzer
â”‚   â”‚   â”œâ”€â”€ description: ...
â”‚   â”‚   â”œâ”€â”€ auto_generated: true
â”‚   â”‚   â””â”€â”€ category: data_analysis
â”‚   â””â”€â”€ Body (Markdown)
â”‚       â”œâ”€â”€ Overview
â”‚       â”œâ”€â”€ Quick Start
â”‚       â”œâ”€â”€ Tools
â”‚       â””â”€â”€ Notes
â”‚
â””â”€â”€ csv_analyzer.py             # Python è„šæœ¬
    â”œâ”€â”€ analyze_csv() å‡½æ•°
    â”œâ”€â”€ main() å…¥å£
    â”œâ”€â”€ é”™è¯¯å¤„ç†
    â””â”€â”€ JSON è¾“å‡º
```

---

## ğŸ”§ è‡ªå®šä¹‰å’Œæ‰©å±•

### æ·»åŠ æ–°çš„æŠ€èƒ½ç±»å‹

ç¼–è¾‘ `skills/skill-creator/scripts/auto_create_skill.py`:

```python
def analyze_requirement(requirement: str) -> dict:
    # æ·»åŠ æ–°çš„æ£€æµ‹æ¨¡å¼
    if any(kw in requirement_lower for kw in ["video", "mp4", "avi"]):
        skill_info["skill_name"] = "video_processor"
        skill_info["dependencies"] = ["opencv-python"]
        skill_info["input_params"] = ["video_path"]
        skill_info["category"] = "video_processing"
```

### è‡ªå®šä¹‰è„šæœ¬æ¨¡æ¿

```python
def generate_video_processor_script() -> str:
    return '''#!/usr/bin/env python3
"""
Video Processor - Process video files
Auto-generated skill
"""
import sys
import json

def process_video(video_path: str) -> dict:
    try:
        import cv2
        # ä½ çš„è§†é¢‘å¤„ç†é€»è¾‘
        return {"status": "success", "result": "..."}
    except Exception as e:
        return {"status": "error", "error": str(e)}

def main():
    # ... å…¥å£é€»è¾‘
    pass

if __name__ == "__main__":
    main()
'''
```

---

## ğŸ§ª æµ‹è¯•

### è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•

```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
./tests/test-auto-skill-creation.sh

# æµ‹è¯•ç‰¹å®šæŠ€èƒ½ç±»å‹
python3 skills/skill-creator/scripts/auto_create_skill.py "Test requirement"
```

### æ‰‹åŠ¨æµ‹è¯•

```bash
# 1. åˆ›å»ºæŠ€èƒ½
python3 skills/skill-creator/scripts/auto_create_skill.py "Analyze CSV file"

# 2. æŸ¥çœ‹ç”Ÿæˆçš„æ–‡ä»¶
ls -la skills/csv_analyzer/

# 3. æµ‹è¯•è„šæœ¬
echo "name,age\nAlice,30\nBob,25" > test.csv
python3 skills/csv_analyzer/csv_analyzer.py test.csv

# 4. æŸ¥çœ‹è¾“å‡º
cat output.json | python3 -m json.tool
```

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: Python è„šæœ¬æ‰§è¡Œå¤±è´¥

**ç—‡çŠ¶**: `python3: command not found`

**è§£å†³**:

```bash
# macOS
brew install python3

# Ubuntu/Debian
sudo apt-get install python3

# Windows
# ä» python.org ä¸‹è½½å®‰è£…
```

### é—®é¢˜ 2: ä¾èµ–å®‰è£…å¤±è´¥

**ç—‡çŠ¶**: `ModuleNotFoundError: No module named 'pandas'`

**è§£å†³**:

```bash
# æ‰‹åŠ¨å®‰è£…ä¾èµ–
pip3 install pandas pillow requests beautifulsoup4

# ä½¿ç”¨å›½å†…é•œåƒï¼ˆä¸­å›½ç”¨æˆ·ï¼‰
pip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple pandas
```

### é—®é¢˜ 3: æŠ€èƒ½æœªç”Ÿæ•ˆ

**ç—‡çŠ¶**: AI æ²¡æœ‰ä½¿ç”¨æ–°åˆ›å»ºçš„æŠ€èƒ½

**æ£€æŸ¥**:

1. æŠ€èƒ½æ˜¯å¦åœ¨ `enabledSkills` åˆ—è¡¨ä¸­
2. SKILL.md æ ¼å¼æ˜¯å¦æ­£ç¡®
3. è„šæœ¬æ˜¯å¦æœ‰æ‰§è¡Œæƒé™: `chmod +x skills/*//*.py`

### é—®é¢˜ 4: æƒé™é”™è¯¯

**ç—‡çŠ¶**: `Permission denied`

**è§£å†³**:

```bash
# æ·»åŠ æ‰§è¡Œæƒé™
chmod +x skills/skill-creator/scripts/auto_create_skill.py
chmod +x skills/csv_analyzer/csv_analyzer.py

# æ£€æŸ¥ç›®å½•æƒé™
ls -la skills/
```

---

## ğŸ“š å‚è€ƒèµ„æº

### æ–‡æ¡£

- [åŠ¨æ€æŠ€èƒ½åˆ›å»ºæ–¹æ¡ˆ.md](./åŠ¨æ€æŠ€èƒ½åˆ›å»ºæ–¹æ¡ˆ.md) - å®Œæ•´è®¾è®¡æ–¹æ¡ˆ
- [integration-guide.md](./src/agent/gemini/integration-guide.md) - é›†æˆæŒ‡å—
- [SKILL.md](./skills/skill-creator/SKILL.md) - æŠ€èƒ½åˆ›å»ºå™¨æ–‡æ¡£

### ä»£ç 

- `skills/skill-creator/scripts/auto_create_skill.py` - è‡ªåŠ¨åˆ›å»ºè„šæœ¬
- `src/agent/gemini/SkillManager.ts` - æŠ€èƒ½ç®¡ç†å™¨
- `tests/test-auto-skill-creation.sh` - æµ‹è¯•è„šæœ¬

### ç¤ºä¾‹

```bash
# æŸ¥çœ‹ç¤ºä¾‹æŠ€èƒ½
ls -la skills/weather-lookup/
cat skills/weather-lookup/SKILL.md
```

---

## ğŸ“ æœ€ä½³å®è·µ

### 1. æŠ€èƒ½å‘½å

- ä½¿ç”¨å°å†™å­—æ¯å’Œä¸‹åˆ’çº¿
- æè¿°æ€§åç§°: `csv_analyzer` è€Œä¸æ˜¯ `tool1`
- é¿å…ç‰¹æ®Šå­—ç¬¦

### 2. é”™è¯¯å¤„ç†

- æ‰€æœ‰è„šæœ¬éƒ½åº”è¯¥è¿”å› JSON
- åŒ…å« `status` å­—æ®µ: `success` æˆ– `error`
- æä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯

### 3. ä¾èµ–ç®¡ç†

- åœ¨ SKILL.md ä¸­åˆ—å‡ºæ‰€æœ‰ä¾èµ–
- ä½¿ç”¨å¸¸è§çš„ã€ç¨³å®šçš„åº“
- æä¾›å®‰è£…è¯´æ˜

### 4. æ–‡æ¡£ç¼–å†™

- æ¸…æ™°çš„ä½¿ç”¨ç¤ºä¾‹
- å®Œæ•´çš„å‚æ•°è¯´æ˜
- è¾“å‡ºæ ¼å¼è¯´æ˜

---

## ğŸš€ ä¸‹ä¸€æ­¥

1. **æµ‹è¯•åŠŸèƒ½**: è¿è¡Œ `./tests/test-auto-skill-creation.sh`
2. **é›†æˆåˆ° Agent**: æŒ‰ç…§ `integration-guide.md` é›†æˆ
3. **åˆ›å»ºè‡ªå®šä¹‰æŠ€èƒ½**: æ·»åŠ ä½ éœ€è¦çš„æŠ€èƒ½ç±»å‹
4. **åˆ†äº«æŠ€èƒ½**: å°†æœ‰ç”¨çš„æŠ€èƒ½åˆ†äº«ç»™ç¤¾åŒº

---

## ğŸ’¡ è´¡çŒ®

æ¬¢è¿è´¡çŒ®æ–°çš„æŠ€èƒ½ç±»å‹å’Œæ”¹è¿›ï¼

1. Fork é¡¹ç›®
2. æ·»åŠ æ–°çš„æŠ€èƒ½æ¨¡æ¿
3. æµ‹è¯•åŠŸèƒ½
4. æäº¤ Pull Request

---

**ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼å¦‚æœæœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ•…éšœæ’æŸ¥éƒ¨åˆ†æˆ–æäº¤ Issueã€‚** ğŸ‰
